<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoXcuses - Exercises</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            background-color: #1a1a1a;
            color: #fff;
            font-family: 'Inter', sans-serif;
            padding-bottom: 5rem;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col antialiased">
    <header class="w-full p-4 fixed top-0 z-10 flex justify-center items-center bg-gray-900 shadow-lg">
        <h1 class="text-2xl font-bold text-white">Exercises</h1>
    </header>
    <main class="flex-grow container mx-auto p-4 pt-20 relative">
        <section id="exercise-list" class="space-y-2"></section>
        <!-- Alphabet slider -->
        <div id="alpha-slider" class="fixed right-2 top-24 z-40 flex flex-col items-center bg-gray-900 bg-opacity-80 rounded-lg p-1 select-none">
            <!-- Letters will be injected here -->
        </div>
    </main>
    <!-- Exercise Modal -->
    <div id="exercise-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 text-gray-900 relative">
            <button id="close-exercise-modal" class="absolute top-2 right-3 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
            <h2 id="modal-ex-name" class="text-xl font-semibold mb-2"></h2>
            <div class="flex border-b mb-4">
                <button class="modal-tab px-3 py-1 text-sm font-semibold text-gray-700 border-b-2 border-transparent focus:outline-none" data-tab="notes">Notes</button>
                <button class="modal-tab px-3 py-1 text-sm font-semibold text-gray-700 border-b-2 border-transparent focus:outline-none" data-tab="history">History</button>
                <button class="modal-tab px-3 py-1 text-sm font-semibold text-gray-700 border-b-2 border-transparent focus:outline-none" data-tab="best">Best Sets</button>
            </div>
            <div id="modal-tab-content">
                <!-- Tab content will be injected here -->
            </div>
        </div>
    </div>
    <script>
        let allExercises = [];
        let exerciseHistory = {}; // For demo, could be loaded from localStorage
        fetch('exercises.json')
            .then(res => res.json())
            .then(exercises => {
                allExercises = exercises.slice().sort((a, b) => a.name.localeCompare(b.name));
                renderExerciseList(allExercises);
                renderAlphaSlider(allExercises);
            });

        function renderExerciseList(exercises) {
            const list = document.getElementById('exercise-list');
            list.innerHTML = '';
            let lastLetter = '';
            exercises.forEach((ex, idx) => {
                const firstLetter = ex.name[0].toUpperCase();
                if (firstLetter !== lastLetter) {
                    list.insertAdjacentHTML('beforeend', `<div id="letter-${firstLetter}" class="text-xs font-bold text-gray-400 mt-3 mb-1">${firstLetter}</div>`);
                    lastLetter = firstLetter;
                }
                const div = document.createElement('div');
                div.className = "bg-white rounded-lg shadow p-3 text-gray-900 cursor-pointer hover:bg-blue-50 transition";
                div.textContent = ex.name;
                div.onclick = () => openExerciseModal(ex);
                list.appendChild(div);
            });
        }

        function renderAlphaSlider(exercises) {
            const slider = document.getElementById('alpha-slider');
            slider.innerHTML = '';
            const letters = Array.from(new Set(exercises.map(e => e.name[0].toUpperCase())));
            letters.forEach(letter => {
                const btn = document.createElement('div');
                btn.className = 'text-xs font-bold text-gray-300 hover:text-blue-400 cursor-pointer px-1 py-0.5';
                btn.textContent = letter;
                btn.onclick = () => {
                    const el = document.getElementById('letter-' + letter);
                    if (el) el.scrollIntoView({behavior: 'smooth', block: 'start'});
                };
                slider.appendChild(btn);
            });
        }

        // Modal logic
        const modal = document.getElementById('exercise-modal');
        const closeModalBtn = document.getElementById('close-exercise-modal');
        const modalExName = document.getElementById('modal-ex-name');
        const modalTabContent = document.getElementById('modal-tab-content');
        let currentExercise = null;

        function openExerciseModal(ex) {
            currentExercise = ex;
            modalExName.textContent = ex.name;
            setActiveTab('notes');
            modal.classList.remove('hidden');
        }
        closeModalBtn.onclick = () => modal.classList.add('hidden');
        document.querySelectorAll('.modal-tab').forEach(tabBtn => {
            tabBtn.onclick = function() {
                setActiveTab(this.dataset.tab);
            };
        });
        function setActiveTab(tab) {
            document.querySelectorAll('.modal-tab').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                if (btn.dataset.tab === tab) btn.classList.add('border-blue-500', 'text-blue-600');
            });
            if (!currentExercise) return;
            if (tab === 'notes') {
                modalTabContent.innerHTML = currentExercise.notes ? `<div class='text-gray-800'>${currentExercise.notes}</div>` : '<div class="text-gray-400">No notes for this exercise.</div>';
            } else if (tab === 'history') {
                // For demo, show lastPerformedSet if available
                if (currentExercise.lastPerformedSet) {
                    modalTabContent.innerHTML = `<div class='text-gray-800'>Last Performed: <span class='font-semibold'>${currentExercise.lastPerformedSet.weight} x ${currentExercise.lastPerformedSet.reps} (${currentExercise.lastPerformedSet.date})</span></div>`;
                } else {
                    modalTabContent.innerHTML = '<div class="text-gray-400">No history for this exercise.</div>';
                }
            } else if (tab === 'best') {
                if (currentExercise.highestVolumeSet) {
                    modalTabContent.innerHTML = `<div class='text-gray-800'>Highest Volume: <span class='font-semibold'>${currentExercise.highestVolumeSet.weight} x ${currentExercise.highestVolumeSet.reps} (${currentExercise.highestVolumeSet.date})</span></div>`;
                } else {
                    modalTabContent.innerHTML = '<div class="text-gray-400">No best set for this exercise.</div>';
                }
            }
        }
    </script>
    <nav class="fixed bottom-0 left-0 w-full bg-gray-800 border-t border-gray-700 shadow-lg md:hidden z-50">
    <ul class="flex justify-around items-center h-16">
        <li class="flex-1">
            <a href="index.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                HOME_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-home text-xl"></i>
                <span class="text-xs mt-1">Home</span>
            </a>
        </li>
        <li class="flex-1">
            <a href="history.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                HISTORY_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-history text-xl"></i>
                <span class="text-xs mt-1">History</span>
            </a>
        </li>
        <li class="flex-1">
            <a href="workout.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                WORKOUT_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-plus-circle text-3xl"></i>
                <span class="text-xs mt-1">Start</span>
            </a>
        </li>
        <li class="flex-1">
            <a href="exercises.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                EXERCISES_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-dumbbell text-xl"></i>
                <span class="text-xs mt-1">Exercises</span>
            </a>
        </li>
    </ul>
</nav>
<script>
// Navbar highlight logic
(function() {
    const path = window.location.pathname;
    const nav = document.querySelector('nav');
    if (!nav) return;
    let page = '';
    if (path.endsWith('index.html')) page = 'HOME';
    else if (path.endsWith('history.html')) page = 'HISTORY';
    else if (path.endsWith('workout.html')) page = 'WORKOUT';
    else if (path.endsWith('exercises.html')) page = 'EXERCISES';
    nav.innerHTML = nav.innerHTML
        .replace('HOME_ACTIVE', page==='HOME' ? 'text-blue-500' : 'text-gray-400')
        .replace('HISTORY_ACTIVE', page==='HISTORY' ? 'text-blue-500' : 'text-gray-400')
        .replace('WORKOUT_ACTIVE', page==='WORKOUT' ? 'text-blue-500' : 'text-gray-400')
        .replace('EXERCISES_ACTIVE', page==='EXERCISES' ? 'text-blue-500' : 'text-gray-400');
})();
</script>
</body>
</html>