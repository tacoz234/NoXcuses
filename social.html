<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NoXcuses - Social Feed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            background-color: #1a1a1a;
            color: #fff;
            font-family: 'Inter', sans-serif;
            padding-bottom: 5rem;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col antialiased">
    <header class="w-full p-4 fixed top-0 z-10 flex justify-between items-center bg-gray-900 shadow-lg">
        <h1 class="text-2xl font-bold text-white">Social Feed</h1>
        <a href="account.html" id="account-btn" class="text-white hover:text-blue-400 text-2xl ml-4 flex items-center justify-center rounded-full w-10 h-10 bg-gray-800 hover:bg-gray-700 transition-colors duration-200" title="Account">
            <i class="fas fa-user-circle"></i>
        </a>
    </header>
    <main class="flex-grow container mx-auto p-4 pt-20 relative">
        <section id="social-feed" class="space-y-4">
            <div class="bg-white p-4 rounded-lg shadow-md text-gray-900">
                <h2 class="text-xl font-semibold mb-2">Welcome to the Social Feed!</h2>
                <p class="text-gray-700">This is where you'll see updates from your friends. Stay tuned!</p>
            </div>
        </section>
    </main>
    <nav class="fixed bottom-0 left-0 w-full bg-gray-800 border-t border-gray-700 shadow-lg md:hidden z-50">
    <ul class="flex justify-around items-center h-16">
        <li class="flex-1">
        <a href="index.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2 HOME_ACTIVE text-blue-500 hover:text-blue-400">
          <i class="fas fa-chart-line text-xl"></i>
          <span class="text-xs mt-1">Progress</span>
        </a>
      </li>
        <li class="flex-1">
            <a href="history.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                HISTORY_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-history text-xl"></i>
                <span class="text-xs mt-1">History</span>
            </a>
        </li>
        <li class="flex-1">
                <a href="workout.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                    WORKOUT_ACTIVE
                    text-blue-500 hover:text-blue-400">
                    <i class="fas fa-plus-circle text-3xl"></i>
                    <span class="text-xs mt-1">Start</span>
                </a>
            </li>
        <li class="flex-1">
            <a href="social.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2 
            SOCIAL_ACTIVE text-blue-500 hover:text-blue-400">
                    <i class="fas fa-users text-xl"></i>
                    <span class="text-xs mt-1">Social</span>
                </a>
        </li>
        <li class="flex-1">
            <a href="exercises.html" class="flex flex-col items-center justify-center transition-colors duration-300 p-2
                EXERCISES_ACTIVE
                text-blue-500 hover:text-blue-400">
                <i class="fas fa-dumbbell text-xl"></i>
                <span class="text-xs mt-1">Exercises</span>
            </a>
        </li>
    </ul>
</nav>

    <!-- Plus button for posting -->
    <button id="post-btn" class="fixed bottom-20 right-4 bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 z-40">
        <i class="fas fa-plus text-2xl"></i>
    </button>

    <!-- Share Modal -->
    <div id="share-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-11/12 md:w-1/3 relative">
            <h3 class="text-xl font-bold mb-4 text-white">What would you like to share?</h3>
            <button id="close-modal-btn" class="absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
            <ul class="space-y-4">
                <li><button class="share-option w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200" data-share-type="template">Share Template</button></li>
                <li><button class="share-option w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200" data-share-type="workout">Share Workout</button></li>
                <li><button class="share-option w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200" data-share-type="playlist">Share Playlist</button></li>
                <li><button class="share-option w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200" data-share-type="pr">Share PR</button></li>
            </ul>
        </div>
    </div>

    <!-- Template Share Modal -->
    <div id="template-share-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-11/12 md:w-1/2 relative">
            <h3 class="text-xl font-bold mb-4 text-white">Select a Template to Share</h3>
            <button class="close-sub-modal-btn absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
            <div id="template-list-container" class="space-y-2 max-h-96 overflow-y-auto"></div>
        </div>
    </div>

    <!-- Workout Share Modal -->
    <div id="workout-share-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-11/12 md:w-1/2 relative">
            <h3 class="text-xl font-bold mb-4 text-white">Select a Workout to Share</h3>
            <button class="close-sub-modal-btn absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
            <div id="workout-list-container" class="space-y-2 max-h-96 overflow-y-auto"></div>
        </div>
    </div>

    <!-- Playlist Share Modal -->
    <div id="playlist-share-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-11/12 md:w-1/2 relative">
            <h3 class="text-xl font-bold mb-4 text-white">Select a Playlist to Share</h3>
            <button class="close-sub-modal-btn absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
            <div id="playlist-list-container" class="space-y-2 max-h-96 overflow-y-auto"></div>
        </div>
    </div>

    <!-- PR Share Modal -->
    <div id="pr-share-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl w-11/12 md:w-1/2 relative">
            <h3 class="text-xl font-bold mb-4 text-white">Share a Personal Record (PR)</h3>
            <button class="close-sub-modal-btn absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
            <div class="space-y-4">
                <div>
                    <label for="pr-video-upload" class="block text-white text-sm font-bold mb-2">Upload Video (Optional):</label>
                    <input type="file" id="pr-video-upload" accept="video/*" class="block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                </div>
                <div>
                    <label for="pr-exercise-select" class="block text-white text-sm font-bold mb-2">Select Exercise:</label>
                    <select id="pr-exercise-select" class="block w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white"></select>
                </div>
                <div>
                    <label for="pr-weight-input" class="block text-white text-sm font-bold mb-2">Weight (optional):</label>
                    <input type="number" id="pr-weight-input" placeholder="e.g., 100" class="block w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white"/>
                </div>
                <button id="submit-pr-share" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md transition">Share PR</button>
            </div>
        </div>
    </div>

    <script>
        (function() {
            const path = window.location.pathname;
            const nav = document.querySelector('nav');
            if (!nav) return;
            let page = '';
            if (path.endsWith('index.html')) page = 'HOME';
            else if (path.endsWith('history.html')) page = 'HISTORY';
            else if (path.endsWith('workout.html')) page = 'WORKOUT';
            else if (path.endsWith('exercises.html')) page = 'EXERCISES';
            else if (path.endsWith('social.html')) page = 'SOCIAL';

            nav.innerHTML = nav.innerHTML
                .replace('HOME_ACTIVE', page==='HOME' ? 'text-blue-500' : 'text-gray-400')
                .replace('HISTORY_ACTIVE', page==='HISTORY' ? 'text-blue-500' : 'text-gray-400')
                .replace('WORKOUT_ACTIVE', page==='WORKOUT' ? 'text-blue-500' : 'text-gray-400')
                .replace('EXERCISES_ACTIVE', page==='EXERCISES' ? 'text-blue-500' : 'text-gray-400')
                .replace('SOCIAL_ACTIVE', page==='SOCIAL' ? 'text-blue-500' : 'text-gray-400');

            // Main Share Modal functionality
            const postBtn = document.getElementById('post-btn');
            const shareModal = document.getElementById('share-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const shareOptions = document.querySelectorAll('.share-option');

            postBtn.addEventListener('click', () => {
                shareModal.classList.remove('hidden');
            });

            closeModalBtn.addEventListener('click', () => {
                shareModal.classList.add('hidden');
            });

            shareModal.addEventListener('click', (e) => {
                if (e.target === shareModal) {
                    shareModal.classList.add('hidden');
                }
            });

            // Sub-modal functionality
            const templateShareModal = document.getElementById('template-share-modal');
            const workoutShareModal = document.getElementById('workout-share-modal');
            const playlistShareModal = document.getElementById('playlist-share-modal');
            const prShareModal = document.getElementById('pr-share-modal');
            const closeSubModalBtns = document.querySelectorAll('.close-sub-modal-btn');

            shareOptions.forEach(option => {
                option.addEventListener('click', () => {
                    shareModal.classList.add('hidden'); // Hide main share modal
                    const shareType = option.dataset.shareType;
                    if (shareType === 'template') {
                        templateShareModal.classList.remove('hidden');
                        loadTemplates();
                    } else if (shareType === 'workout') {
                        workoutShareModal.classList.remove('hidden');
                        loadWorkouts();
                    } else if (shareType === 'playlist') {
                        playlistShareModal.classList.remove('hidden');
                        loadPlaylists();
                    } else if (shareType === 'pr') {
                        prShareModal.classList.remove('hidden');
                        loadExercisesForPR();
                    }
                });
            });

            closeSubModalBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.target.closest('.fixed').classList.add('hidden');
                });
            });

            // Close sub-modals when clicking outside
            [templateShareModal, workoutShareModal, playlistShareModal, prShareModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                });
            });

            // Functions to load data (to be implemented)
            async function loadTemplates() {
                const templateListContainer = document.getElementById('template-list-container');
                templateListContainer.innerHTML = '<p class="text-gray-400">Loading templates...</p>';
                try {
                    const response = await fetch('templates.json');
                    const data = await response.json();
                    const templates = Array.isArray(data) ? data : (data.templates || []);
                    if (templates.length === 0) {
                        templateListContainer.innerHTML = '<p class="text-gray-400">No templates found.</p>';
                        return;
                    }
                    templateListContainer.innerHTML = templates.map(tpl => `
                        <button class="w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200 template-item" data-template-name="${tpl.name}">
                            ${tpl.name}
                        </button>
                    `).join('');
                    templateListContainer.querySelectorAll('.template-item').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            alert(`Sharing template: ${e.target.dataset.templateName}`);
                            templateShareModal.classList.add('hidden');
                        });
                    });
                } catch (error) {
                    console.error('Error loading templates:', error);
                    templateListContainer.innerHTML = '<p class="text-red-400">Error loading templates.</p>';
                }
            }

            function loadWorkouts() {
                const workoutListContainer = document.getElementById('workout-list-container');
                const workoutHistory = JSON.parse(localStorage.getItem('workoutHistory') || '[]');
                if (workoutHistory.length === 0) {
                    workoutListContainer.innerHTML = '<p class="text-gray-400">No workout history found.</p>';
                    return;
                }
                workoutListContainer.innerHTML = workoutHistory.reverse().map(workout => `
                    <button class="w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200 workout-item" data-workout-date="${workout.date}">
                        Workout on ${new Date(workout.date).toLocaleString()}
                    </button>
                `).join('');
                workoutListContainer.querySelectorAll('.workout-item').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        alert(`Sharing workout from: ${e.target.dataset.workoutDate}`);
                        workoutShareModal.classList.add('hidden');
                    });
                });
            }

            async function loadPlaylists() {
                const playlistListContainer = document.getElementById('playlist-list-container');
                playlistListContainer.innerHTML = '<p class="text-gray-400">Loading playlists...</p>';
                try {
                    const response = await fetch('templates.json'); // Assuming playlists are in templates.json or similar
                    const data = await response.json();
                    // Assuming playlists are under a 'playlists' key in templates.json or similar structure
                    const playlists = data.playlists || []; // Adjust this based on actual JSON structure

                    if (playlists.length === 0) {
                        playlistListContainer.innerHTML = '<p class="text-gray-400">No playlists found.</p>';
                        return;
                    }
                    playlistListContainer.innerHTML = playlists.map(playlist => `
                        <button class="w-full text-left bg-gray-700 hover:bg-gray-600 text-white py-3 px-4 rounded-md text-lg transition-colors duration-200 playlist-item" data-playlist-name="${playlist.name}">
                            ${playlist.name}
                        </button>
                    `).join('');
                    playlistListContainer.querySelectorAll('.playlist-item').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            alert(`Sharing playlist: ${e.target.dataset.playlistName}`);
                            playlistShareModal.classList.add('hidden');
                        });
                    });
                } catch (error) {
                    console.error('Error loading playlists:', error);
                    playlistListContainer.innerHTML = '<p class="text-red-400">Error loading playlists.</p>';
                }
            }

            async function loadExercisesForPR() {
                const exerciseSelect = document.getElementById('pr-exercise-select');
                exerciseSelect.innerHTML = '<option>Loading exercises...</option>';
                try {
                    const response = await fetch('exercises.json');
                    const exercises = await response.json();
                    if (exercises.length === 0) {
                        exerciseSelect.innerHTML = '<option>No exercises found</option>';
                        return;
                    }
                    exerciseSelect.innerHTML = exercises.map(ex => `<option value="${ex.name}">${ex.name}</option>`).join('');
                } catch (error) {
                    console.error('Error loading exercises:', error);
                    exerciseSelect.innerHTML = '<option>Error loading exercises</option>';
                }
            }

            const submitPrShareBtn = document.getElementById('submit-pr-share');
            submitPrShareBtn.addEventListener('click', () => {
                const videoFile = document.getElementById('pr-video-upload').files[0];
                const selectedExercise = document.getElementById('pr-exercise-select').value;
                const weight = document.getElementById('pr-weight-input').value;
                let message = `Sharing PR for exercise: ${selectedExercise}`;
                if (weight) {
                    message += ` with weight: ${weight}`;
                }
                if (videoFile) {
                    message += ` with video: ${videoFile.name}`;
                }
                alert(message);
                prShareModal.classList.add('hidden');
            });
        })();
    </script>
</body>
</html>